/*-- scss:defaults --*/

// ====================================
//  WoW Tooltip System Variables
// ====================================

// Import authentic WoW font (Friz Quadrata)
$font-url: "https://assets.codepen.io/13471/";

// Rarity colors (WoW standard) - updated to match CodePen exactly
$rarity-poor: #999999;
$rarity-common: #ffffff;
$rarity-uncommon: #24ee10;
$rarity-rare: #0070DD;
$rarity-epic: #ad23ed;
$rarity-legendary: #fa7c18;
$spell-color: #87CEEB; // Lighter blue for spells (Sky Blue)

// Tooltip background and border (exact from CodePen)
$tooltip-bg: rgba(10, 0, 5, 0.8);
$tooltip-shadow: rgba(10, 0, 5, 0.5);
$border-image-url: url('https://assets.codepen.io/13471/wow-tooltip-border-2.png');

/*-- scss:mixins --*/

@mixin raid-icon-base {
  content: "";
  display: inline-block;
  width: var(--icon-size, 1em);
  height: var(--icon-size, 1em);
  margin-right: 0.3em;
  vertical-align: middle;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
}

/*-- scss:rules --*/

// ====================================
//  WoW Font Face Definition
// ====================================

@font-face {
    font-family: 'friz';
    src: url('#{$font-url}friz_quadrata_regular-webfont.eot');
    src: url('#{$font-url}friz_quadrata_regular-webfont.eot?#iefix') format('embedded-opentype'),
         url('#{$font-url}friz_quadrata_regular-webfont.woff') format('woff'),
         url('#{$font-url}friz_quadrata_regular-webfont.ttf') format('truetype'),
         url('#{$font-url}friz_quadrata_regular-webfont.svg#friz_quadrataregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

// ====================================
//  Turtle Link Styling
// ====================================

// Remove underlines from anchor tags containing turtle links
a:has(.turtle-link), a .turtle-link {
  text-decoration: none !important;
}

a:hover:has(.turtle-link), a:hover .turtle-link {
  text-decoration: none !important;
}

// Base turtle-link styling
.turtle-link {
  cursor: pointer;
  text-decoration: none !important;
  transition: opacity 0.2s ease;
  
  &:hover {
    opacity: 0.8;
    text-decoration: none !important; // Ensure no underline on hover
  }
  
  // Spell styling
  &.spell {
    color: $spell-color;
    font-weight: 500;
  }
  
  // Item rarity colors
  &.item {
    font-weight: 500;
    
    &.poor {
      color: $rarity-poor;
    }
    
    &.common {
      color: $rarity-common;
    }
    
    &.uncommon {
      color: $rarity-uncommon;
    }
    
    &.rare {
      color: $rarity-rare;
    }
    
    &.epic {
      color: $rarity-epic;
    }
    
    &.legendary {
      color: $rarity-legendary;
    }
  }
  
  // Achievement styling
  &.achievement {
    color: $rarity-epic;
    font-weight: 500;
  }
  
  // Custom type styling (fallback)
  &.custom {
    color: $rarity-uncommon;
    font-weight: 500;
  }
}

// Inline icon support for turtle links
.turtle-link {
  position: relative;
  padding-left: 20px;
  
  &::before {
    @include raid-icon-base;
    background-image: var(--turtle-icon, url('https://res.cloudinary.com/dhmmkvcpy/image/upload/q_auto,f_auto/Interface/Icons/inv_misc_questionmark.jpg'));
    width: 16px;
    height: 16px;
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
  }
  
  // Hide icon when explicitly disabled
  &[data-show-inline-icon="false"]::before {
    display: none;
  }
  
  // Remove left padding when no icon
  &[data-show-inline-icon="false"] {
    padding-left: 0;
  }
}

// ====================================
//  WoW Tooltip Styling
// ====================================

// Authentic WoW tooltip styling (exact from CodePen)
.turtle-tooltip {
  position: absolute;
  
  // Exact styling from CodePen
  color: white;
  background-color: $tooltip-bg;
  
  font-family: "friz", serif;
  font-size: 12px;
  font-weight: normal;
  padding: 0.5em 0.6em;
  text-shadow: 0 1px 0 rgba(0,0,0,1);
  
  // Authentic WoW border using border-image (exact from CodePen)
  border-style: solid;
  border-width: 5px;
  border-image: $border-image-url 5 repeat;
  border-radius: 4px;
  
  // Shadow effect (exact from CodePen)
  box-shadow:
    -1px -1px 1px $tooltip-shadow,
    -1px 1px 1px $tooltip-shadow,
    1px 1px 1px $tooltip-shadow,
    1px -1px 1px $tooltip-shadow;
  
  max-width: 24em;
  z-index: 10000;
  
  // Animation (exact from CodePen)
  display: none;
  pointer-events: none;
  
  transition: 
    opacity 0.05s ease-out 0.05s,
    transform 0.1s ease-out 0.05s;
  
  // Prevent text selection
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  
  // Show state
  &.visible {
    display: block;
    opacity: 1;
    transform: scale(1);
  }
  
  // Hidden state (exact from CodePen)
  &.hidden {
    visibility: hidden;
    opacity: 0;
    transform: scale(0.95);

    transition: 
      opacity 0.05s ease-out 0.05s,
      transform 0.1s ease-out 0.05s,
      visibility 0.01s linear 0.15s;
  }
  
  // Reset margins for all paragraphs
  p {
    padding: 0;
    margin: 0;
  }
  
  // Tooltip header styling
  .tooltip-header {
    margin-bottom: 3px;
    
    .tooltip-title {
      font-size: 1.12em;
      margin-bottom: 3px;
      margin-right: 1em;
      
      // Rarity colors for titles
      &.poor { color: $rarity-poor; }
      &.common { color: $rarity-common; }
      &.uncommon { color: $rarity-uncommon; }
      &.rare { color: $rarity-rare; }
      &.epic { color: $rarity-epic; }
      &.legendary { color: $rarity-legendary; }
      &.spell { color: $spell-color; }
    }
    
    .tooltip-subtitle {
      color: #FFD100;
      font-size: 0.9em;
    }
  }
  
  // Database-style spell tooltip layout
  .spell-title-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 2px;
    
    .spell-name {
      font-weight: bold;
      color: white;
      font-size: 1.12em;
    }
    
    .spell-rank {
      color: #999999;
      font-size: 1.12em;
      font-weight: bold;
    }
  }
  
  .spell-cost-range-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 2px;
    
    .spell-cost {
      color: white;
    }
    
    .spell-range {
      color: white;
    }
  }
  
  .spell-cast-time {
    color: white;
    margin-bottom: 3px;
  }
  
  .spell-reagents {
    color: white;
    margin-bottom: 2px;
  }
  
  .spell-tools {
    color: white;
    margin-bottom: 3px;
  }
  
  // Description text
  .tooltip-description {
    margin-top: 3px;
    line-height: 1.3;
  }
  
  // Spell description with green color (original database style)
  .spell-description {
    color: #24ee10; // Green color similar to uncommon items (reverted back)
    margin-top: 3px;
    line-height: 1.3;
  }
  
  // Special text colors
  .tooltip-enchant {
    color: $rarity-uncommon;
    margin-top: 3px;
  }
  
  .tooltip-flavour {
    color: #FFD100;
    margin-top: 3px;
    font-style: italic;
  }
  
  // ====================================
  //  Item Tooltip Structure (CodePen style)
  // ====================================
  
  // Item header
  .item-header {
    margin-bottom: 3px;
    
    .item-title {
      font-size: 1.12em;
      margin-bottom: 3px;
      font-weight: bold;
      
      // Rarity colors for item titles
      &.poor { color: $rarity-poor; }
      &.common { color: $rarity-common; }
      &.uncommon { color: $rarity-uncommon; }
      &.rare { color: $rarity-rare; }
      &.epic { color: $rarity-epic; }
      &.legendary { color: $rarity-legendary; }
    }
    
    .item-binding,
    .item-unique {
      color: white;
      font-size: 1em;
      margin: 0;
    }
  }
  
  // Item type row (slot | type with left/right alignment)
  .item-type-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin: 3px 0;
    
    .item-slot {
      color: white;
    }
    
    .item-type {
      color: white;
    }
  }
  
  // Damage and speed row (damage | speed with left/right alignment)
  .item-damage-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin: 2px 0;
    
    .item-damage {
      color: white;
    }
    
    .item-speed {
      color: white;
    }
  }
  
  // DPS (damage per second)
  .item-dps {
    color: white;
    margin: 2px 0;
  }
  
  // Item stats list
  .item-stats {
    margin: 3px 0;
    
    .item-stat {
      color: white;
      margin: 1px 0;
    }
  }
  
  // Armor
  .item-armor {
    color: white;
    margin: 2px 0;
  }
  
  // Level requirement
  .item-level-req {
    color: white;
    margin: 3px 0;
  }
  
  // Durability
  .item-durability {
    color: white;
    margin: 3px 0;
  }
  
  // Special effects (chance on hit, etc.) - green color like enchantments
  .item-special-effect {
    color: $rarity-uncommon; // Green color for special effects
    margin-top: 3px;
    line-height: 1.3;
  }
  
  // ====================================
  //  Secondary Crafting Frame
  // ====================================
  
  .crafting-frame {
    margin-top: 6px;
    padding-top: 6px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    
    .crafting-header {
      margin-bottom: 3px;
      
      .crafting-title {
        color: #FFD100; // Gold color for profession name
        font-weight: bold;
        font-size: 1.12em;
        margin: 0;
      }
    }
    
    .crafting-cast-time {
      color: white;
      margin: 2px 0;
    }
    
    .crafting-reagents {
      color: white;
      margin: 2px 0;
    }
    
    .crafting-tools {
      color: white;
      margin: 2px 0;
    }
  }
}

// ====================================
//  Tooltip Icon Styling
// ====================================

// Tooltip icon (separate from main tooltip) - using same styling as tooltip
.turtle-tooltip-icon {
  position: absolute;
  width: 54px;
  height: 54px;
  z-index: 10001;
  display: none;
  pointer-events: none;
  
  // Same exact styling as tooltip
  border-style: solid;
  border-width: 5px;
  border-image: $border-image-url 5 repeat;
  border-radius: 4px;
  background: $tooltip-bg;
  padding: 2px;
  
  // Same shadow effect
  box-shadow:
    -1px -1px 1px $tooltip-shadow,
    -1px 1px 1px $tooltip-shadow,
    1px 1px 1px $tooltip-shadow,
    1px -1px 1px $tooltip-shadow;
  
  // Ensure icon image fits within border properly
  background-size: 130% !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  
  &.visible {
    display: block;
    animation: tooltipFadeIn 0.15s ease-out;
  }
}

// ====================================
//  Animations
// ====================================

// Fade in animation
@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// ====================================
//  Print Styles
// ====================================

// Print styles (hide tooltips when printing)
@media print {
  .turtle-tooltip,
  .turtle-tooltip-icon {
    display: none !important;
  }
  
  .turtle-link {
    border-bottom: none;
    color: inherit;
  }
}